{% extends "./base.html" %} 

{% block content %}
<!-- Attendance Check-In/Out Section -->
<section class="feature_2 bg-light pt-105 pb-45 text-center">
  <div class="container px-xl-0">
    <div class="row justify-content-center">
      <div class="col-xl-8 col-lg-10">
        <h2 class="small" data-aos-duration="600" data-aos="fade-down">
          Attendance Portal
        </h2>
        
        <div class="mt-35 mb-65 f-22 color-heading text-adaptive description" data-aos="fade-down" data-aos-delay="300">
          Your attendance is tied to your current location. Please ensure location services are enabled and you're within the allowed area.
        </div>
      </div>

      <!-- User & Location Info -->
      <div class="col-xl-6 col-lg-8 mb-30" data-aos="fade-up" data-aos-delay="600">
        <div class="p-4 bg-white rounded shadow-sm text-left">
          <h5 class="mb-4 border-bottom pb-2">Welcome, John Doe</h5>
          
          <div class="row mb-3">
            <div class="col-5 font-weight-medium text-secondary">Status:</div>
            <div class="col-7">
              <span class="badge status-badge text-white px-3 py-2 rounded-pill">Inside Allowed Zone</span>
            </div>
          </div>
          
          <div class="row mb-3">
            <div class="col-5 font-weight-medium text-secondary">Current Time:</div>
            <div class="col-7 font-weight-bold" id="current-time">09:45 AM</div>
          </div>
          
          <div class="row mb-3">
            <div class="col-5 font-weight-medium text-secondary">GPS Accuracy:</div>
            <div class="col-7 font-weight-bold">±12 meters</div>
          </div>
          
          <div class="row mb-4">
            <div class="col-5 font-weight-medium text-secondary">Location:</div>
            <div class="col-7 font-weight-bold">6.5244° N, 3.3792° E</div>
          </div>

          <!-- Check In/Out Buttons with improved visibility -->
          <div class="row">
            <div class="col-6">
              <button type="button" class="btn btn-primary w-100 py-2 attendance-btn" id="check-in-btn">
                <span class="attendance-btn-text">Check In</span>
              </button>
            </div>
            <div class="col-6">
              <button type="button" class="btn btn-danger w-100 py-2 attendance-btn" id="check-out-btn">
                <span class="attendance-btn-text">Check Out</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Today's Attendance Log -->
      <div class="col-xl-6 col-lg-8 mb-30" data-aos="fade-up" data-aos-delay="900">
        <div class="p-4 bg-white rounded shadow-sm text-left">
          <h5 class="mb-4 border-bottom pb-2">Today's Log</h5>
          
          <div class="row mb-3">
            <div class="col-5 font-weight-medium text-secondary">Check-In Time:</div>
            <div class="col-7 font-weight-bold" id="check-in-time">—</div>
          </div>
          
          <div class="row mb-3">
            <div class="col-5 font-weight-medium text-secondary">Check-Out Time:</div>
            <div class="col-7 font-weight-bold" id="check-out-time">—</div>
          </div>
          
          <div class="row">
            <div class="col-5 font-weight-medium text-secondary">Total Time:</div>
            <div class="col-7 font-weight-bold" id="total-time">—</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
/* Targeted styles only for attendance buttons */
.attendance-btn {
  visibility: visible !important;
  opacity: 1 !important;
  transition: background-color 0.3s ease !important;
  white-space: nowrap !important;
  overflow: visible !important;
  text-overflow: clip !important;
  display: inline-block !important;
  width: 100% !important;
}

.attendance-btn-text {
  visibility: visible !important;
  display: inline-block !important;
  width: auto !important;
}

#check-in-btn {
  background-color: #000000 !important;
  border-color: #000000 !important;
  color: white !important;
}

#check-out-btn {
  background-color: #333333 !important;
  border-color: #333333 !important;
  color: white !important;
}

.status-badge {
  background-color: #000000 !important;
}

/* Ensure text inside buttons is visible */
.attendance-btn:hover {
  opacity: 0.8 !important;
}
</style>

<script>
  // Initialize current time as soon as the DOM is loaded
  document.addEventListener('DOMContentLoaded', function() {
    // Time update function
    function updateCurrentTime() {
      const now = new Date();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const ampm = hours >= 12 ? 'PM' : 'AM';
      const formattedHours = hours % 12 || 12;
      const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
      const timeString = `${formattedHours}:${formattedMinutes} ${ampm}`;
      
      // Update the time display
      document.getElementById('current-time').textContent = timeString;
    }
    
    // Update time immediately and then every minute
    updateCurrentTime();
    setInterval(updateCurrentTime, 60000);
    
    // Check-in button functionality
    document.getElementById('check-in-btn').addEventListener('click', function() {
      const now = new Date();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const ampm = hours >= 12 ? 'PM' : 'AM';
      const formattedHours = hours % 12 || 12;
      const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
      const timeString = `${formattedHours}:${formattedMinutes} ${ampm}`;
      
      // Set check-in time
      document.getElementById('check-in-time').textContent = timeString;
      // Reset check-out time
      document.getElementById('check-out-time').textContent = '—';
      // Reset total time
      document.getElementById('total-time').textContent = '—';
      
      // Disable check-in button and enable check-out button
      this.disabled = true;
      document.getElementById('check-out-btn').disabled = false;
    });
    
    // Check-out button functionality
    document.getElementById('check-out-btn').addEventListener('click', function() {
      const now = new Date();
      const hours = now.getHours();
      const minutes = now.getMinutes();
      const ampm = hours >= 12 ? 'PM' : 'AM';
      const formattedHours = hours % 12 || 12;
      const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
      const timeString = `${formattedHours}:${formattedMinutes} ${ampm}`;
      
      // Set check-out time
      document.getElementById('check-out-time').textContent = timeString;
      
      // Calculate total time (simplified for demo)
      document.getElementById('total-time').textContent = '8 hours';
      
      // Enable check-in button and disable check-in button
      document.getElementById('check-in-btn').disabled = false;
      this.disabled = true;
    });
  });
</script>
{% endblock content %}

