{% extends "./base.html" %} {% block content %}

<style>
/* Loader spinner animation */
.spinner {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top: 2px solid white;
    animation: spin 1s linear infinite;
    margin-right: 8px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Button loading state */
.btn-loading {
    pointer-events: none;
    opacity: 0.8;
}

.btn-loading:hover {
    background-color: #28a745 !important;
}
</style>

<div
   class="pitch"
   style="
      min-height: 80vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding-top: 150px;
      padding-bottom: 2opx;
   "
>
   <div style="width: 100%; max-width: 500px; text-align: center">
      <h1
         class="wow fadeInDown"
         data-wow-delay="0s"
         style="text-align: center; margin-bottom: 30px; color: black"
      >
         Create your GeoTrack account
      </h1>
      
      {% if messages %}
         {% for message in messages %}
            <div
               style="
               padding: 0.75rem 1.25rem;
               margin-bottom: 1rem;
               border-radius: 0.25rem;
               {% if 'error' in message.tags %}
                  border: 1px solid red;
                  background-color: rgba(255,0,0,0.1);
                  color: red;
               {% elif 'success' in message.tags %}
                  border: 1px solid green;
                  background-color: rgba(0,128,0,0.1);
                  color: green;
               {% else %}
                  border: 1px solid #777;
                  background-color: rgba(0,0,0,0.05);
                  color: #333;
               {% endif %}
               "
            >
               {{ message }}
            </div>
         {% endfor %}
      {% endif %}

      <div
         style="
            background-color: #ffffff;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: left;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
         "
      >
         <form method="post" action="{% url 'myapp:register' %}" id="registerForm">
            {% csrf_token %}
            <div style="margin-bottom: 20px">
               <label
                  for="first_name"
                  style="
                     display: block;
                     margin-bottom: 8px;
                     font-weight: 500;
                     color: #555;
                  "
                  >Firstname</label
               >
               <input
                  type="text"
                  class="form-control"
                  id="first_name"
                  name="first_name"
                  placeholder="Your Firstname"
                  required
                  style="
                     width: 100%;
                     padding: 12px;
                     border: 1px solid #ddd;
                     border-radius: 6px;
                     font-size: 12px;
                     color: #333; 
                  "
               />
            </div>

            <div style="margin-bottom: 20px">
               <label
                  for="last_name"
                  style="
                     display: block;
                     margin-bottom: 8px;
                     font-weight: 500;
                     color: #555;
                  "
                  >Lastname</label
               >
               <input
                  type="text"
                  class="form-control"
                  id="last_name"
                  name="last_name"
                  placeholder="Your Lastname"
                  required
                  style="
                     width: 100%;
                     padding: 12px;
                     border: 1px solid #ddd;
                     border-radius: 6px;
                     font-size: 12px;
                     color: #333; 
                  "
               />
            </div>

            <div style="margin-bottom: 20px">
               <label
                  for="email"
                  style="
                     display: block;
                     margin-bottom: 8px;
                     font-weight: 500;
                     color: #555;
                  "
                  >Email address</label
               >
               <input
                  type="email"
                  class="form-control"
                  id="email"
                  name="email"
                  placeholder="you@example.com"
                  required
                  style="
                     width: 100%;
                     padding: 12px;
                     border: 1px solid #ddd;
                     border-radius: 6px;
                     font-size: 14px;
                     color: #333; 
                  "
               />
            </div>
            
            <div style="margin-bottom: 20px">
               <label
                  for="password"
                  style="
                     display: block;
                     margin-bottom: 8px;
                     font-weight: 500;
                     color: #555;
                  "
                  >Password</label
               >
               <input
                  type="password"
                  class="form-control"
                  id="password"
                  name="password"
                  placeholder="••••••••"
                  required
                  style="
                     width: 100%;
                     padding: 12px;
                     border: 1px solid #ddd;
                     border-radius: 6px;
                     font-size: 14px;
                     color: #333; 
                  "
               />
               <small 
                  style="color: #666; font-size: 12px;"
                  >Password must be at least 8 characters long</small>
            </div>
            <div style="margin-bottom: 25px">
               <label
                  for="confirm_password"
                  style="
                     display: block;
                     margin-bottom: 8px;
                     font-weight: 500;
                     color: #555;
                  "
                  >Confirm Password</label
               >
               <input
                  type="password"
                  class="form-control"
                  id="confirm_password"
                  name="confirm_password"
                  placeholder="••••••••"
                  required
                  style="
                     width: 100%;
                     padding: 12px;
                     border: 1px solid #ddd;
                     border-radius: 6px;
                     font-size: 14px;
                     color: #333; 
                  "
               />
            </div>
            <button
               type="submit"
               id="registerBtn"
               style="
                  width: 100%;
                  padding: 14px 20px;
                  background-color: #28a745;
                  color: white;
                  border: none;
                  border-radius: 6px;
                  font-size: 16px;
                  font-weight: 500;
                  cursor: pointer;
                  transition: background-color 0.2s;
                  display: flex;
                  align-items: center;
                  justify-content: center;
               "
               onmouseover="if (!this.classList.contains('btn-loading')) this.style.backgroundColor='#218838'"
               onmouseout="if (!this.classList.contains('btn-loading')) this.style.backgroundColor='#28a745'"
            >
               <span id="btnText">Register</span>
            </button>
         </form>
         <p
            style="
               margin-top: 20px;
               text-align: center;
               color: #666;
               font-size: 14px;
            "
         >
            Already have an account?
            <a
               href="{% url 'myapp:login' %}"
               style="color: #007bff; text-decoration: none"
               >Login here</a
            >
         </p>
      </div>
   </div>
</div>

<script>
document.getElementById('registerForm').addEventListener('submit', function(e) {
    const btn = document.getElementById('registerBtn');
    const btnText = document.getElementById('btnText');
    
    // Add loading state
    btn.classList.add('btn-loading');
    btnText.innerHTML = '<span class="spinner"></span>Creating account...';
    
    // Optional: Add a small delay to show the loader (remove in production)
    // setTimeout(() => {
    //     this.submit();
    // }, 500);
});

// Reset button state if form submission fails (e.g., validation errors)
window.addEventListener('load', function() {
    const btn = document.getElementById('registerBtn');
    const btnText = document.getElementById('btnText');
    
    btn.classList.remove('btn-loading');
    btnText.innerHTML = 'Register';
});
</script>

{% endblock %}